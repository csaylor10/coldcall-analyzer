(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{8044:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ea});var n=r(5933),o=r(5155),s=r(2115);let a=r(3464).A.create({baseURL:"https://pmcdnsk3jztr4h-8000.proxy.runpod.net",headers:{Accept:"application/json"}});var l=r(6710),i=r(364),d=r(7217),c=r(8407),u=r(700),f=r(8164),g=r(2491),x=r(8534),m=r(3196),h=r(2548),p=r(2939),b=r(4581),y=r(1101),A=r(3148),j=r(5297),v=r(5528),_=r(2376),S=r(4220),w=r(9990),F=r(2390),I=r(2110),R=r(1218),C=r(6632),k=r(7262),E=r(5726),N=r(4426),z=r(86),O=r(5808),W=r(6278),L=r(4492),D=r(9927),U=r(1977);function P(e){let{open:t,prompt:r,setPrompt:n,onClose:s,onGenerate:a,result:l,loading:i,error:d}=e,c=async e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];r&&n(await r.text())};return(0,o.jsxs)(W.A,{open:t,onClose:s,maxWidth:"sm",fullWidth:!0,children:[(0,o.jsx)(L.A,{children:"Generate Coaching Plan"}),(0,o.jsxs)(D.A,{children:[(0,o.jsx)(u.A,{variant:"body2",sx:{mb:1},children:"Enter a prompt or context for the coaching plan:"}),(0,o.jsx)(g.A,{label:"Prompt",value:r,onChange:e=>n(e.target.value),fullWidth:!0,multiline:!0,minRows:2,disabled:i,sx:{mb:2}}),(0,o.jsxs)(x.A,{component:"label",variant:"outlined",sx:{mb:2},children:["Upload Prompt",(0,o.jsx)("input",{type:"file",accept:".txt",hidden:!0,onChange:c})]}),d&&(0,o.jsx)(f.A,{severity:"error",sx:{mb:2},children:d}),i&&(0,o.jsx)(N.A,{size:32,sx:{display:"block",mx:"auto",my:2}}),l&&(0,o.jsxs)(f.A,{severity:"success",sx:{whiteSpace:"pre-line",mt:2},children:[(0,o.jsx)(u.A,{variant:"subtitle1",sx:{mb:1},children:"Coaching Plan:"}),l,(0,o.jsx)(x.A,{sx:{mt:2},variant:"contained",color:"secondary",onClick:()=>{if(!l)return;let e=new Blob([l],{type:"text/plain"}),t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download="coaching_plan.txt",r.click(),URL.revokeObjectURL(t)},children:"Download Coaching Plan"})]})]}),(0,o.jsxs)(U.A,{children:[(0,o.jsx)(x.A,{onClick:s,disabled:i,children:"Close"}),(0,o.jsx)(x.A,{onClick:a,disabled:i||!r,variant:"contained",color:"primary",children:"Generate"})]})]})}var B=r(4905),J=r(2405),M=r(8748),G=r(3199),T=r(3380),q=r(1890);function H(){let e=(0,n._)(["\n    0% { transform: scale(1); filter: drop-shadow(0 0 0 #00d1ff44); }\n    50% { transform: scale(1.08); filter: drop-shadow(0 0 10px #00d1ff); }\n    100% { transform: scale(1); filter: drop-shadow(0 0 0 #00d1ff44); }\n  "]);return H=function(){return e},e}let Y=(0,i.A)({palette:{mode:"light",primary:{main:"#0F2A54"},secondary:{main:"#00D1FF"},success:{main:"#00C36F"},warning:{main:"#FFB42A"},error:{main:"#FF3B30"},background:{default:"#F4F6F8",paper:"#FFFFFF"},text:{primary:"#21262E",secondary:"#707A8A"}}});function K(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];(window.DEBUG_LOGS||"true"===localStorage.getItem("DEBUG_LOGS"))&&console.log("[DEBUG]",...t)}function X(e){let{onAuth:t}=e,[r,n]=(0,s.useState)("login"),[l,i]=(0,s.useState)(""),[m,h]=(0,s.useState)(""),[p,b]=(0,s.useState)(""),[y,A]=(0,s.useState)(!1),j=async e=>{e.preventDefault(),b(""),A(!0),K("AuthForm Submit:",r,l);try{if("register"===r)await a.post("/auth/register",{email:l,password:m}),n("login"),b("Registration successful! Please log in.");else{let e=new URLSearchParams({username:l,password:m}),r=await a.post("/auth/jwt/login",e,{headers:{"Content-Type":"application/x-www-form-urlencoded"}});K("Login Success:",r.data),t(r.data.access_token)}}catch(e){var o,s,i;K("Auth Error:",e),b((null===(i=e.response)||void 0===i?void 0:null===(s=i.data)||void 0===s?void 0:null===(o=s.detail)||void 0===o?void 0:o.toString())||e.message)}finally{A(!1)}};return(0,o.jsx)(d.A,{maxWidth:"xs",children:(0,o.jsxs)(c.A,{elevation:3,sx:{p:4,mt:8},children:[(0,o.jsx)(u.A,{variant:"h5",align:"center",gutterBottom:!0,children:"login"===r?"Login":"Register"}),p&&(0,o.jsx)(f.A,{severity:"register"===r&&p&&p.startsWith("Registration")?"success":"error",sx:{mb:2},children:p}),(0,o.jsxs)("form",{onSubmit:j,children:[(0,o.jsx)(g.A,{label:"Email",type:"email",value:l,onChange:e=>i(e.target.value),required:!0,fullWidth:!0,sx:{mb:2}}),(0,o.jsx)(g.A,{label:"Password",type:"password",value:m,onChange:e=>h(e.target.value),required:!0,fullWidth:!0,sx:{mb:2}}),(0,o.jsx)(x.A,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,disabled:y,sx:{mb:2},children:y?"login"===r?"Logging in…":"Registering…":"login"===r?"Log In":"Register"})]}),(0,o.jsxs)(u.A,{variant:"body2",align:"center",children:["login"===r?"Need an account?":"Already have an account?"," ",(0,o.jsx)(x.A,{variant:"text",size:"small",onClick:()=>{n("login"===r?"register":"login"),b("")},children:"login"===r?"Register":"Login"})]})]})})}function V(e){return e.reduce((e,t)=>{if("voicemail"===(t.categorization||"").toLowerCase().replace(/\s+/g,""))return e;let r=(t.rep_name||"Unknown Rep").trim().toLowerCase();return e[r]||(e[r]=[]),e[r].push(t),e},{})}function $(e,t){let r=e.map(e=>"number"==typeof e[t]?e[t]:parseFloat(e[t])).filter(e=>!isNaN(e));return 0===r.length?null:r.reduce((e,t)=>e+t,0)/r.length}function Q(e){let t=new Set;return e.filter(e=>!t.has(e.jobId)&&(t.add(e.jobId),!0))}function Z(e){let{filename:t,full_analysis_content:r,red_flags:n,red_flag_reason:o,red_flag_quotes:s,missed_custom_red_flags:a}=e;return'<!DOCTYPE html>\n<html lang="en">\n<head>\n  <meta charset="UTF-8" />\n  <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n  <title>Analysis Report: '.concat(t,"</title>\n  <style>\n    body { font-family: 'Segoe UI', sans-serif; background-color: #F4F6F8; color: #21262E; padding: 20px; }\n    .container { max-width: 900px; margin: auto; padding: 25px; background-color: #FFFFFF; box-shadow: 0 4px 10px 0 rgba(0,0,0,0.1); border-radius: 8px; }\n    h1, h2 { color: #00D1FF; }\n    .analysis-content { line-height: 1.6; font-size: 16px; margin-bottom: 20px; }\n    .red-flags { background-color: #FFEBE9; border-left: 5px solid #FF3B30; padding: 15px; border-radius: 5px; margin-top: 20px; }\n    blockquote { font-style: italic; background-color: #E9EEF2; padding: 10px; border-radius: 5px; }\n    .transcript-block { background: #E9EEF2; padding: 16px; border-radius: 6px; white-space: pre-wrap; font-family: monospace; margin-top: 2em; }\n    .missed-flags { background-color: #FFF9E5; border-left: 5px solid #FFB42A; padding: 15px; border-radius: 5px; margin-top: 20px; }\n    footer { margin-top: 30px; text-align: center; color: #707A8A; font-size: 12px; }\n  </style>\n</head>\n<body>\n  <div class=\"container\">\n    <h1>\uD83D\uDCCA Analysis Report: ").concat(t,'</h1>\n    <div class="analysis-content">\n      ').concat(r.replace(/\n/g,"<br />"),"\n    </div>\n    ").concat("Yes"===n?'<div class="red-flags">\n      <h2>\uD83D\uDEA9 Red Flags Detected</h2>\n      <p><strong>Reason:</strong> '.concat(o||"N/A","</p>\n      ").concat("None"!==s?"<blockquote>".concat(s,"</blockquote>"):"","\n    </div>"):"","\n    ").concat(a&&a.length>0?'<div class="missed-flags">\n      <h2>⚠️ Missed Custom Red Flags</h2>\n      <ul>'.concat(a.map(e=>"<li>".concat(e,"</li>")).join(""),'</ul>\n      <p style="color:#B26A00;">These red flags were present in the transcript but not flagged by the AI. Please review them manually.</p>\n    </div>'):"",'\n    <hr style="margin:2em 0;">\n    <footer>Generated automatically by Greener Living AI Analysis.</footer>\n  </div>\n</body>\n</html>')}function ee(e){let t=e.map(e=>({...e,content:e.full_analysis_content||e.content||"",blob:void 0,url:void 0,file:void 0}));localStorage.setItem("downloads",JSON.stringify(t))}function et(){try{let e=localStorage.getItem("downloads");if(!e)return[];return JSON.parse(e).map(e=>{let t="string"==typeof e.content?e.content:"",r=new Blob([t],{type:"text/html"}),n=URL.createObjectURL(r);return{...e,blob:r,url:n,full_analysis_content:t}})}catch(e){return[]}}function er(e){localStorage.setItem("analyzingJobs",JSON.stringify(e))}function en(){try{let e=localStorage.getItem("analyzingJobs");if(!e)return[];return JSON.parse(e)}catch(e){return[]}}function eo(e){localStorage.setItem("erroredJobs",JSON.stringify(e))}function es(){try{let e=localStorage.getItem("erroredJobs");if(!e)return[];return JSON.parse(e)}catch(e){return[]}}function ea(){let[e,t]=(0,s.useState)(null),[r,n]=(0,s.useState)(""),[i,c]=(0,s.useState)(()=>et()),[W,L]=(0,s.useState)(0),[D,U]=(0,s.useState)(0),[ea,el]=(0,s.useState)(0),[ei,ed]=(0,s.useState)("idle"),[ec,eu]=(0,s.useState)(null),[ef,eg]=(0,s.useState)(""),[ex,em]=(0,s.useState)(()=>{try{return JSON.parse(localStorage.getItem("customRedFlags")||"[]")}catch(e){return[]}}),[eh,ep]=(0,s.useState)(!1),[eb,ey]=(0,s.useState)("starter"),[eA,ej]=(0,s.useState)(!1),[ev,e_]=(0,s.useState)({}),[eS,ew]=(0,s.useState)(!1),[eF,eI]=(0,s.useState)(""),[eR,eC]=(0,s.useState)(""),[ek,eE]=(0,s.useState)(!1),[eN,ez]=(0,s.useState)(""),[eO,eW]=(0,s.useState)([]),[eL,eD]=(0,s.useState)(""),[eU,eP]=(0,s.useState)(""),[eB,eJ]=(0,s.useState)(()=>en()),[eM,eG]=(0,s.useState)(()=>es()),[eT,eq]=(0,s.useState)(!1),[eH,eY]=(0,s.useState)(!1),[eK,eX]=(0,s.useState)(""),[eV,e$]=(0,s.useState)(()=>{try{return JSON.parse(localStorage.getItem("currentReps")||"[]")}catch(e){return[]}}),[eQ,eZ]=(0,s.useState)(!1),[e0,e1]=(0,s.useState)({open:!1,message:"",severity:"success"}),[e2,e4]=(0,s.useState)(""),[e3,e5]=(0,s.useState)({email:""}),[e6,e8]=(0,s.useState)({});(0,s.useEffect)(()=>{localStorage.setItem("customRedFlags",JSON.stringify(ex))},[ex]),(0,s.useEffect)(()=>{localStorage.setItem("currentReps",JSON.stringify(eV))},[eV]),(0,s.useEffect)(()=>{ee(i)},[i]),(0,s.useEffect)(()=>{er(eB)},[eB]),(0,s.useEffect)(()=>{eo(eM)},[eM]),(0,s.useEffect)(()=>{c(et()),eJ(en()),eG(es())},[]);let e7={};function e9(){Object.keys(e7).forEach(e=>delete e7[e])}function te(e){if(e7[e.jobId])return;e7[e.jobId]=!0;let t=async()=>{try{let{status:n,result:o}=(await a.get("/job-status/".concat(e.jobId))).data;if(e_(t=>({...t,[e.jobId]:{status:n,result:o}})),"done"===n){var r;let t=(null==o?void 0:o.fileName)||e.fileName||"Analysis Report.html",n=Z({filename:t,full_analysis_content:(null==o?void 0:o.full_analysis_content)||"",red_flags:null==o?void 0:o.red_flags,red_flag_reason:null==o?void 0:o.red_flag_reason,red_flag_quotes:null==o?void 0:o.red_flag_quotes,missed_custom_red_flags:(null==o?void 0:o.missed_custom_red_flags)||[]}),s=new Blob([n],{type:"text/html"}),a=URL.createObjectURL(s),l=Array.isArray(null==o?void 0:o.custom_red_flags_found)?o.custom_red_flags_found.length:0,i=Array.isArray(null==o?void 0:o.system_red_flags_found)?o.system_red_flags_found.length:0;console.log("JOB COMPLETE:",e.jobId,"Custom Flags:",l,null==o?void 0:o.custom_red_flags_found,"System Flags:",i,null==o?void 0:o.system_red_flags_found),c(r=>{var n;return n={...o,jobId:e.jobId,fileName:t,blob:s,url:a,full_analysis_content:(null==o?void 0:o.full_analysis_content)||"",displayName:t,custom_red_flags_found:(null==o?void 0:o.custom_red_flags_found)||[],system_red_flags_found:(null==o?void 0:o.system_red_flags_found)||[]},r.filter(e=>e.jobId!==n.jobId).concat([n])}),r=e.jobId,er(en().filter(e=>e.jobId!==r)),eJ(en()),delete e7[e.jobId]}else if("error"===n){let t=es(),r={...e,result:o};eo([...t,r]),eG(es()),delete e7[e.jobId]}else e7[e.jobId]&&setTimeout(t,5e3)}catch(t){e_(r=>({...r,[e.jobId]:{status:"error",error:t}})),delete e7[e.jobId]}};t()}(0,s.useEffect)(()=>{e&&eB.forEach(e=>{i.some(t=>t.jobId===e.jobId)||te(e)})},[eB,e]),q.env.NEXT_PUBLIC_COMPANY;let tt=V(Q(i)),tr=()=>{c([]),localStorage.setItem("downloads",JSON.stringify([]))},tn=()=>{ej(!0),ed("idle")};(0,s.useEffect)(()=>{let e=localStorage.getItem("jwt");e&&t(e)},[]),(0,s.useEffect)(()=>{e&&a.get("/users/me").then(e=>eu(e.data.minutes))},[e,D]),(0,s.useEffect)(()=>{ee(i)},[i]),(0,s.useEffect)(()=>{e&&a.get("/users/me").then(e=>{eu(e.data.minutes),e5({email:e.data.email}),localStorage.setItem("userEmail",e.data.email||"")})},[e,D]),(0,s.useEffect)(()=>{ee(i)},[i]);let to=async e=>{if(!e.length){e1({open:!0,message:"No files selected.",severity:"warning"});return}if(e.length>1e3){e4("❌ You can upload up to 1000 files at a time."),e1({open:!0,message:"Too many files selected (max 1000).",severity:"error"});return}let r=e.find(e=>e.size>0x1900000);if(r){e4("File too large (max 25MB): "+r.name),e1({open:!0,message:"File too large: "+r.name,severity:"error"});return}el(e.length),ed("uploading"),e1({open:!0,message:"Upload started!",severity:"info"}),L(0),U(0),e4("");let n=new FormData;e.forEach(e=>n.append("files",e)),n.append("params",JSON.stringify({custom_red_flags:ex,current_reps:eV}));try{let{job_ids:t}=(await a.post("/upload/",n,{timeout:6e5,onUploadProgress:e=>{e.total&&L(Math.round(100*e.loaded/e.total))}})).data;t.forEach((t,r)=>{let n={jobId:t,fileName:e[r].name},o=en();er([...o,n]),eJ(en()),te(n)})}catch(e){var o,s,l,i;(null===(o=e.response)||void 0===o?void 0:o.status)===413?e4("❌ Upload too large."):(null===(s=e.response)||void 0===s?void 0:s.status)===401?(e4("❌ Session expired. Please log in again."),localStorage.removeItem("jwt"),t(null)):e.message&&e.message.includes("Network Error")?e4("❌ Network error. Please check your connection or try again later."):e4("❌ Upload failed: ".concat((null===(i=e.response)||void 0===i?void 0:null===(l=i.data)||void 0===l?void 0:l.detail)||e.message)),e1({open:!0,message:"Upload failed.",severity:"error"}),ed("idle");return}ed("idle"),e1({open:!0,message:"Upload complete!",severity:"success"}),L(0),U(0)},{getRootProps:ts,getInputProps:ta,isDragActive:tl}=(0,l.VB)({onDrop:to,accept:{"audio/*":[".mp3",".wav",".m4a",".aac",".flac"]},multiple:!0}),ti=(0,T.i7)(H()),td=(0,s.useRef)(null),tc="uploading"===ei&&W>0,tu=D<ea&&ea>0&&!tc,tf=e=>{eI(""),eC(""),ez(""),eD(e),console.log("Opening coaching modal for rep:",e),console.log("repStats[rep]:",tt[e]);let t=(tt[e]||[]).map(e=>(function(e){if(!e)return"";let t=e.match(/Coaching Plan:\s*([\s\S]*?)(?:\n\s*Red Flags:|$)/i);return t?t[1].trim():""})("string"==typeof e.full_analysis_content&&e.full_analysis_content.trim()?e.full_analysis_content:e.analysis||e.transcript||"No analysis available.")).filter(Boolean);eW(t),console.log("coachingAnalyses:",t),ew(!0)},tg=async()=>{let e=eO.length>0?eO.map((e,t)=>"Coaching Plan #".concat(t+1,":\n").concat(e)).join("\n\n"):"",t="".concat(eF,"\n\nHere are this rep's recent coaching plans:\n").concat(e);try{eE(!0),eC(""),ez("");let e=await a.post("/api/generate-coaching-plan",{prompt:t});eC(e.data.result)}catch(e){var r,n,o;ez((null==e?void 0:null===(o=e.response)||void 0===o?void 0:null===(n=o.data)||void 0===n?void 0:null===(r=n.result)||void 0===r?void 0:r.error)||e.message||"Unknown error")}finally{eE(!1)}};return localStorage.getItem("userEmail"),(0,o.jsxs)(m.A,{theme:Y,children:[(0,o.jsx)(h.Ay,{}),e&&(0,o.jsxs)(p.Ay,{variant:"permanent",sx:{width:240,flexShrink:0,whiteSpace:"nowrap",boxSizing:"border-box",bgcolor:"#f8fafc",borderRight:"1px solid #e0e4ea","& .MuiDrawer-paper":{width:240,bgcolor:"#f8fafc",borderRight:"1px solid #e0e4ea",transition:Y.transitions.create("width",{easing:Y.transitions.easing.sharp,duration:Y.transitions.duration.enteringScreen}),overflowX:"hidden",boxShadow:"2px 0 8px 0 rgba(30,40,90,0.03)"}},children:[(0,o.jsx)(b.A,{sx:{width:"100%",height:32,bgcolor:"#fff"}}),(0,o.jsxs)(b.A,{sx:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,o.jsxs)(b.A,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:1,mb:2,px:2,mt:0},children:[(0,o.jsx)(y.A,{label:null===ec?"Loading minutes…":"".concat(ec," minute").concat(1===ec?"":"s"," left"),color:ec>0?"success":"warning",sx:{mr:2,bgcolor:"#f5f7fa",color:"#2b3a55",border:"1px solid #e0e4ea",fontWeight:600,fontSize:14,height:36,borderRadius:2,px:2,mb:1,mt:0,"& .MuiChip-label":{fontSize:14,fontWeight:600,fontFamily:"Inter, sans-serif"}}}),(0,o.jsx)(x.A,{variant:"contained",color:"success",sx:{borderRadius:2,fontWeight:600,fontSize:14,minWidth:120,bgcolor:"#f5f7fa",color:"#2b3a55",border:"1px solid #e0e4ea",boxShadow:"none",textTransform:"none",height:36,mt:0,mb:1,"&:hover":{bgcolor:"#e3e8f0",borderColor:"#b6c3d1",color:"#2b3a55"},fontFamily:"Inter, sans-serif"},onClick:()=>ep(!0),children:"Buy Minutes"})]}),(0,o.jsxs)(A.A,{sx:{px:1,pt:2,gap:2,flexGrow:1},children:[(0,o.jsx)(j.A,{title:"Custom Red Flags",placement:"right",arrow:!0,disableHoverListener:!0,children:(0,o.jsx)(v.Ay,{disablePadding:!0,sx:{display:"block",borderRadius:2,mb:1,borderLeft:eT?"4px solid #00D1FF":"4px solid transparent",transition:"all 0.2s"},children:(0,o.jsxs)(_.A,{onClick:()=>eq(!eT),sx:{minHeight:44,borderRadius:2,px:2.5,gap:1.5},children:[(0,o.jsx)(B.A,{sx:{fontSize:24,color:"#00D1FF"}}),(0,o.jsx)(S.A,{primary:"Custom Red Flags",sx:{ml:1,color:"#0F2A54",fontWeight:600}})]})})}),(0,o.jsx)(w.A,{in:eT,timeout:300,unmountOnExit:!0,children:(0,o.jsxs)(b.A,{sx:{px:3,py:2,bgcolor:"#fff",borderRadius:2,boxShadow:"0 2px 8px 0 rgba(30,40,90,0.03)"},children:[(0,o.jsx)(g.A,{placeholder:"Add Red Flag",value:ef,onChange:e=>eg(e.target.value),onKeyDown:e=>{"Enter"===e.key&&ef.trim()&&(em([...ex,ef.trim()]),eg(""))},size:"small",fullWidth:!0,sx:{mb:1,bgcolor:"#f5f7fa",borderRadius:2,"& .MuiOutlinedInput-root":{fontSize:14,height:36}},InputLabelProps:{shrink:!1},inputProps:{style:{borderRadius:8,padding:"8px 10px"}}}),(0,o.jsx)(b.A,{sx:{display:"flex",flexWrap:"wrap",gap:1,minHeight:24},children:ex.map((e,t)=>(0,o.jsx)(y.A,{label:e,onDelete:()=>em(ex.filter((e,r)=>r!==t)),sx:{bgcolor:"#f5f7fa",color:"#2b3a55",border:"1px solid #e0e4ea",fontWeight:600,fontSize:13,height:28,transition:"all 0.2s","&:hover":{bgcolor:"#e3e8f0",borderColor:"#b6c3d1"},boxShadow:"0 1px 3px 0 rgba(30,40,90,0.03)"},variant:"outlined"},t))})]})}),(0,o.jsx)(j.A,{title:"Current Reps",placement:"right",arrow:!0,disableHoverListener:!0,children:(0,o.jsx)(v.Ay,{disablePadding:!0,sx:{display:"block",borderRadius:2,mb:1,borderLeft:eH?"4px solid #00D1FF":"4px solid transparent",transition:"all 0.2s"},children:(0,o.jsxs)(_.A,{onClick:()=>eY(!eH),sx:{minHeight:44,borderRadius:2,px:2.5,gap:1.5},children:[(0,o.jsx)(J.A,{sx:{fontSize:24,color:"#00D1FF"}}),(0,o.jsx)(S.A,{primary:"Current Reps",sx:{ml:1,color:"#0F2A54",fontWeight:600}})]})})}),(0,o.jsx)(w.A,{in:eH,timeout:300,unmountOnExit:!0,children:(0,o.jsxs)(b.A,{sx:{px:3,py:2,bgcolor:"#fff",borderRadius:2,boxShadow:"0 2px 8px 0 rgba(30,40,90,0.03)"},children:[(0,o.jsx)(g.A,{placeholder:"Add Rep Name",value:eK,onChange:e=>eX(e.target.value),onKeyDown:e=>{"Enter"===e.key&&eK.trim()&&(e$([...eV,eK.trim()]),eX(""))},size:"small",fullWidth:!0,sx:{mb:1,bgcolor:"#f5f7fa",borderRadius:2,"& .MuiOutlinedInput-root":{fontSize:14,height:36}},InputLabelProps:{shrink:!1},inputProps:{style:{borderRadius:8,padding:"8px 10px"}}}),(0,o.jsx)(b.A,{sx:{display:"flex",flexWrap:"wrap",gap:1,minHeight:24},children:eV.map((e,t)=>(0,o.jsx)(y.A,{label:e,onDelete:()=>e$(eV.filter((e,r)=>r!==t)),sx:{bgcolor:"#f5f7fa",color:"#2b3a55",border:"1px solid #e0e4ea",fontWeight:600,fontSize:13,height:28,transition:"all 0.2s","&:hover":{bgcolor:"#e3e8f0",borderColor:"#b6c3d1"},boxShadow:"0 1px 3px 0 rgba(30,40,90,0.03)"},variant:"outlined"},t))})]})})]}),(0,o.jsxs)(b.A,{sx:{flexShrink:0,mb:2,px:2},children:[(0,o.jsx)(F.A,{sx:{mb:2}}),(0,o.jsx)(b.A,{sx:{height:48}}),e3.email&&(0,o.jsx)(u.A,{sx:{fontSize:14,color:"#0f2a54",fontWeight:600,mb:1,textAlign:"left"},children:e3.email}),(0,o.jsx)(b.A,{sx:{height:8}}),(0,o.jsx)(x.A,{startIcon:(0,o.jsx)(O.A,{}),onClick:()=>{K("Logout"),localStorage.removeItem("jwt"),t(null),eu(null),c([]),e9()},fullWidth:!0,color:"error",variant:"outlined",sx:{borderRadius:99,fontWeight:600,fontSize:13},children:"Logout"})]})]})]}),(0,o.jsx)(b.A,{sx:{flexGrow:1,ml:30*!!e},children:e?(0,o.jsx)(b.A,{sx:{bgcolor:"background.default",minHeight:"100vh"},children:(0,o.jsxs)(d.A,{maxWidth:"lg",children:[(0,o.jsx)(b.A,{sx:{height:16}}),Object.keys(tt).length>0&&(0,o.jsx)(b.A,{sx:{mb:4},children:Object.entries(tt).map(e=>{let[t,r]=e;console.log("Talk-to-listen ratios for",t,":",r.map(e=>e.talk_to_listen_ratio));let n=(r.reduce((e,t)=>e+(parseInt((t.overall_perf||"").split("/")[0],10)||0),0)/r.length).toFixed(1),s=r.reduce((e,t)=>e+("number"==typeof t.system_red_flags_count?t.system_red_flags_count:t.system_red_flags_count||0)+(Array.isArray(t.custom_red_flags_found)?t.custom_red_flags_found.length:0),0),a=$(r,"talk_to_listen_ratio"),l=$(r,"nos_before_accept"),i=r.reduce((e,t)=>{let r=(t.categorization||"Unknown").trim();return e[r]=(e[r]||0)+1,e},{});return(0,o.jsx)(I.A,{item:!0,xs:12,sm:6,md:4,children:(0,o.jsx)(R.A,{elevation:3,sx:{borderRadius:3},children:(0,o.jsxs)(C.A,{children:[(0,o.jsx)(u.A,{variant:"h6",sx:{mb:1},children:t}),(0,o.jsx)(y.A,{label:"Calls: ".concat(r.length),color:"info",sx:{mr:1}}),(0,o.jsx)(y.A,{label:"Avg Score: ".concat(n),color:"success",sx:{mr:1}}),(0,o.jsx)(y.A,{label:"Red Flags: ".concat(s),color:s>0?"error":"success",sx:{mr:1}}),(0,o.jsx)(y.A,{label:"Rep talks for: ".concat(null!==a?Math.round(a)+"%":"N/A"),color:"primary",sx:{mr:1}}),(0,o.jsx)(y.A,{label:"Avg No's Before Accept: ".concat(null!==l?l.toFixed(2):"N/A"),color:"secondary"}),(0,o.jsx)(b.A,{sx:{mt:1,mb:1},children:Object.entries(i).map(e=>{let[t,r]=e;return(0,o.jsx)(y.A,{label:"".concat(t,": ").concat(r),size:"small",sx:{mr:.5,mb:.5}},t)})}),(0,o.jsx)(x.A,{variant:"outlined",size:"small",onClick:()=>tf(t),disabled:!(tt[t]&&tt[t].length>0),sx:{mt:2},children:"Generate Coaching Plan"})]})})},t)})}),(0,o.jsx)(P,{open:eS,prompt:eF,setPrompt:eI,onClose:()=>ew(!1),onGenerate:tg,result:eR,loading:ek,error:eN}),(0,o.jsx)(R.A,{sx:{mt:2,mb:4,borderRadius:4,boxShadow:"0 6px 24px 0 rgba(0,209,255,0.07)",p:0,overflow:"visible"},children:(0,o.jsxs)(C.A,{sx:{p:{xs:2,sm:4},display:"flex",flexDirection:"column",alignItems:"center",gap:2},children:[(0,o.jsx)(u.A,{variant:"h4",sx:{fontFamily:"Inter, sans-serif",fontWeight:800,mb:1,letterSpacing:.2},children:"Upload Call Recordings"}),(0,o.jsxs)(b.A,{...ts(),"aria-label":"Upload call recordings",tabIndex:0,sx:{borderRadius:3,background:"linear-gradient(135deg, #e6faff 0%, #f6fcff 100%)",boxShadow:"0 2px 12px 0 rgba(0,209,255,0.10)",border:"none",outline:"2px dashed #00d1ff44",outlineOffset:"-8px",p:{xs:3,sm:5},width:"100%",maxWidth:700,minHeight:180,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",cursor:"pointer",position:"relative",transition:"box-shadow 0.3s, background 0.3s","&:hover":{boxShadow:"0 8px 32px 0 #00d1ff33",background:"linear-gradient(135deg, #e6faff 0%, #e0f7fa 100%)"}},ref:td,children:[(0,o.jsx)("input",{...ta(),"aria-label":"Select files to upload"}),(0,o.jsx)(z.A,{sx:{fontSize:64,color:"#00d1ff",mb:2,animation:"".concat(ti," 1.5s infinite")}}),(0,o.jsx)(u.A,{variant:"h6",sx:{fontFamily:"Inter, sans-serif",fontWeight:700,mb:1},children:"Drag & drop audio files here, or click to select files"}),(0,o.jsxs)(b.A,{sx:{display:"flex",alignItems:"center",gap:.5,mb:1},children:[(0,o.jsx)(u.A,{variant:"body2",sx:{color:"#6b7a90",fontFamily:"Roboto, sans-serif"},children:"Supported: mp3, wav, m4a, etc. (max 1000 files at once)"}),(0,o.jsx)(j.A,{title:"Max file size: 25MB. Supported: mp3, wav, m4a, ogg. Drag anywhere!",children:(0,o.jsx)(M.A,{sx:{fontSize:18,color:"#00d1ff",ml:.5,cursor:"pointer"}})})]}),"uploading"===ei&&(0,o.jsxs)(b.A,{sx:{width:"100%",mt:2},children:[(0,o.jsx)(k.A,{variant:"determinate",value:W,sx:{height:8,borderRadius:4,background:"#e0f7fa","& .MuiLinearProgress-bar":{background:"linear-gradient(90deg, #00C36F 0%, #00D1FF 100%)"}}}),(0,o.jsxs)(u.A,{variant:"body2",sx:{mt:1,color:"#00C36F",fontWeight:600,fontFamily:"Roboto, sans-serif"},children:["Uploading ",D+1," of ",ea," files..."]})]})]})]})}),eB.length>0&&(0,o.jsxs)(b.A,{sx:{width:"100%",mt:2},children:[(0,o.jsx)(u.A,{variant:"h6",gutterBottom:!0,children:"In Progress"}),(0,o.jsx)(x.A,{variant:"outlined",color:"error",sx:{mb:2},onClick:tn,children:"Stop Analyzing"}),eB.map(e=>(0,o.jsxs)(b.A,{sx:{mb:2,p:2,bgcolor:"#FFF3E0",borderRadius:2},children:[(0,o.jsx)(u.A,{variant:"body2",fontWeight:600,children:e.fileName}),(0,o.jsx)(u.A,{variant:"body2",color:"text.secondary",children:"Status: Analyzing..."})]},e.jobId))]}),0===i.length&&0===eB.length&&"uploading"!==ei?(0,o.jsxs)(b.A,{sx:{mt:6,mb:2,display:"flex",flexDirection:"column",alignItems:"center",gap:2},children:[(0,o.jsx)(G.A,{sx:{fontSize:72,color:"#b6c3d1",mb:1}}),(0,o.jsx)(u.A,{variant:"h6",sx:{fontWeight:700,color:"#7e8ba3",mb:1},children:"No completed analyses yet"}),(0,o.jsx)(u.A,{variant:"body2",sx:{color:"#7e8ba3",mb:2,fontFamily:"Roboto, sans-serif"},children:"Upload files to see your first report."})]}):(0,o.jsxs)(b.A,{sx:{mt:4},children:[(0,o.jsxs)(b.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,o.jsx)(u.A,{variant:"h6",children:"Download Reports"}),i.length>0&&(0,o.jsx)(x.A,{variant:"outlined",color:"error",onClick:tr,size:"small",children:"Clear Calls"})]}),0===Object.keys(V(Q(i))).length&&(0,o.jsx)(u.A,{variant:"body2",color:"text.secondary",children:"No completed analyses yet."}),i.length>0&&(0,o.jsx)(b.A,{sx:{display:"flex",justifyContent:"flex-start",mb:2}}),Object.entries(V(Q(i))).map(e=>{let[t,r]=e;return(0,o.jsxs)(b.A,{sx:{mb:2},children:[(0,o.jsx)(u.A,{variant:"subtitle1",fontWeight:600,sx:{mb:1},children:t}),r.map(e=>(0,o.jsxs)(b.A,{sx:{mb:1},children:[(0,o.jsx)(x.A,{variant:"contained",color:function(e){let t=parseInt((e||"").split("/")[0],10);return isNaN(t)?"primary":t>=7?"success":t>=4?"warning":"error"}(e.overall_perf),onClick:()=>(function(e){let t;e.url&&URL.revokeObjectURL(e.url),t=e.full_analysis_content&&e.full_analysis_content.startsWith("<!DOCTYPE html>")?e.full_analysis_content:Z({filename:e.fileName||"Analysis Report",full_analysis_content:e.full_analysis_content||e.content||"",red_flags:e.red_flags,red_flag_reason:e.system_red_flag_reason,red_flag_quotes:e.system_red_flag_quotes,missed_custom_red_flags:e.missed_custom_red_flags||[]});let r=e.fileName||"Analysis Report.html";r.endsWith(".html")||(r+=".html");let n=new Blob([t],{type:"text/html"}),o=URL.createObjectURL(n),s=document.createElement("a");s.href=o,s.download=r,document.body.appendChild(s),s.click(),setTimeout(()=>{URL.revokeObjectURL(o),document.body.removeChild(s)},1e3)})(e),sx:{width:"100%",display:"flex",justifyContent:"flex-start",textTransform:"none",fontWeight:600},children:e.displayName||e.fileName||"Download Report"}),e&&(0,o.jsxs)(b.A,{sx:{mt:1,mb:1,pl:2},children:[(0,o.jsxs)(u.A,{variant:"subtitle2",sx:{color:"#0f2a54",fontWeight:600},children:["System Red Flags: ",Array.isArray(e.system_red_flags_found)?e.system_red_flags_found.length:0]}),Array.isArray(e.system_red_flags_found)&&e.system_red_flags_found.length>0&&(0,o.jsx)(b.A,{sx:{mb:1,pl:1},children:e.system_red_flags_found.map((e,t)=>(0,o.jsx)(u.A,{variant:"body2",sx:{color:"#b71c1c"},children:e},t))}),(0,o.jsxs)(u.A,{variant:"subtitle2",sx:{color:"#0f2a54",fontWeight:600},children:["Custom Red Flags: ",Array.isArray(e.custom_red_flags_found)?e.custom_red_flags_found.length:0]}),Array.isArray(e.custom_red_flags_found)&&e.custom_red_flags_found.length>0&&(0,o.jsx)("div",{style:{marginLeft:12},children:e.custom_red_flags_found.map((t,r)=>(0,o.jsxs)("div",{style:{marginBottom:"4px",color:"#b71c1c",fontSize:"0.95em"},children:[(0,o.jsx)("span",{style:{fontWeight:500},children:t}),e.custom_red_flags_explanations&&e.custom_red_flags_explanations[t]&&(0,o.jsxs)("span",{style:{marginLeft:"8px",fontStyle:"italic"},children:["— ",e.custom_red_flags_explanations[t]]})]},r))})]})]},e.jobId))]},t)})]}),eM.length>0&&(0,o.jsxs)(b.A,{sx:{mt:4},children:[(0,o.jsxs)(b.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,o.jsx)(u.A,{variant:"h6",children:"Failed Analyses"}),eM.length>0&&(0,o.jsx)(x.A,{variant:"outlined",color:"error",onClick:()=>{eG([]),localStorage.setItem("erroredJobs",JSON.stringify([]))},size:"small",children:"Clear Failed Analyses"})]}),eM.map(e=>{var t;return(0,o.jsxs)(b.A,{sx:{mb:2,p:2,bgcolor:"#FFF3E0",borderRadius:2},children:[(0,o.jsx)(u.A,{variant:"body2",fontWeight:600,children:e.fileName}),(0,o.jsx)(u.A,{variant:"body2",color:"text.secondary",children:"Status: Error"}),(0,o.jsx)(u.A,{variant:"body2",color:"error",children:(null===(t=e.result)||void 0===t?void 0:t.error)||"Unknown error"})]},e.jobId)})]})]})}):(0,o.jsx)(X,{onAuth:e=>{K("Auth Success:",e),localStorage.removeItem("analyzingJobs"),localStorage.removeItem("downloads"),localStorage.removeItem("erroredJobs"),e9(),localStorage.setItem("jwt",e),t(e)}})}),(0,o.jsx)(E.A,{open:e0.open,autoHideDuration:4e3,onClose:()=>e1({...e0,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:(0,o.jsx)(f.A,{elevation:6,variant:"filled",onClose:()=>e1({...e0,open:!1}),severity:e0.severity,sx:{fontWeight:600},children:e0.message})}),e2&&(0,o.jsx)(E.A,{open:!!e2,autoHideDuration:6e3,onClose:()=>e4(""),anchorOrigin:{vertical:"top",horizontal:"center"},children:(0,o.jsx)(f.A,{elevation:6,variant:"filled",severity:"error",onClose:()=>e4(""),sx:{fontWeight:600},children:e2})}),tu&&(0,o.jsxs)(b.A,{sx:{display:"flex",alignItems:"center",gap:1,mt:1},children:[(0,o.jsx)(N.A,{size:22,sx:{color:"#00d1ff"}}),(0,o.jsxs)(u.A,{variant:"body2",sx:{fontWeight:500,color:"#00d1ff"},children:["Analyzing... (",D,"/",ea,")"]})]}),tc&&(0,o.jsxs)(b.A,{sx:{display:"flex",alignItems:"center",gap:1,mt:1},children:[(0,o.jsx)(N.A,{size:22,sx:{color:"#00d1ff"}}),(0,o.jsxs)(u.A,{variant:"body2",sx:{fontWeight:500,color:"#00d1ff"},children:["Uploading... (",W,"%)"]})]}),eB.length>0&&(0,o.jsxs)(b.A,{sx:{display:"flex",alignItems:"center",gap:1,mt:1},children:[(0,o.jsx)(x.A,{variant:"outlined",color:"error",sx:{mt:2},onClick:tn,children:"Stop Analyzing"}),(0,o.jsxs)(u.A,{variant:"body2",sx:{fontWeight:500,color:"#00d1ff"},children:[D,"/",ea," files analyzed."]})]}),i.length>0&&(0,o.jsx)(b.A,{sx:{display:"flex",alignItems:"center",gap:1,mt:1},children:(0,o.jsx)(x.A,{variant:"outlined",color:"error",onClick:tr,sx:{mt:2},children:"Clear Calls"})})]})}a.interceptors.request.use(e=>{K("API Request:",e.method,e.url,e);let t=localStorage.getItem("jwt");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>(K("API Request Error:",e),Promise.reject(e))),a.interceptors.response.use(e=>(K("API Response:",e.config.url,e),e),e=>{var t;return K("API Response Error:",null===(t=e.config)||void 0===t?void 0:t.url,e),e.response&&401===e.response.status&&(localStorage.removeItem("jwt"),window.location.reload()),Promise.reject(e)})},8848:(e,t,r)=>{Promise.resolve().then(r.bind(r,8044))}},e=>{var t=t=>e(e.s=t);e.O(0,[39,441,684,358],()=>t(8848)),_N_E=e.O()}]);